<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="464pt" height="821pt" viewBox="0 0 464 821"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 817)"><title>multibuffer</title><polygon fill="#fff" stroke="none" points="-4 4 -4 -817 460 -817 460 4 -4 4"/><g id="node1" class="node"><title>E</title><polygon fill="none" stroke="#000" points="324 -813 252 -813 252 -741 324 -741 324 -813"/><polyline fill="none" stroke="#000" points="264 -813 252 -801"/><polyline fill="none" stroke="#000" points="252 -753 264 -741"/><polyline fill="none" stroke="#000" points="312 -741 324 -753"/><polyline fill="none" stroke="#000" points="324 -801 312 -813"/><text x="288" y="-773.3" font-family="Times,serif" font-size="14" text-anchor="middle">empty</text></g><g id="edge1" class="edge"><title>E-&gt;E</title><path fill="none" stroke="#000" d="M324.087,-788.194C334.221,-787.704 342,-783.973 342,-777 342,-772.642 338.961,-769.55 334.208,-767.725"/><polygon fill="#000" stroke="#000" points="334.564 -764.23 324.087 -765.806 333.26 -771.107 334.564 -764.23"/><text x="370" y="-780.8" font-family="Times,serif" font-size="14" text-anchor="middle">R</text><text x="370" y="-765.8" font-family="Times,serif" font-size="14" text-anchor="middle">(waitread)</text></g><g id="node2" class="node"><title>W_</title><polygon fill="none" stroke="#000" points="99 -690 27 -690 27 -618 99 -618 99 -690"/><text x="63" y="-650.3" font-family="Times,serif" font-size="14" text-anchor="middle">writing</text></g><g id="edge2" class="edge"><title>E-&gt;W_</title><path fill="none" stroke="#000" d="M251.85,-756.559C212.733,-735.523 150.297,-701.947 108.023,-679.213"/><polygon fill="#000" stroke="#000" points="109.525 -676.046 99.06 -674.392 106.21 -682.211 109.525 -676.046"/><text x="196" y="-711.8" font-family="Times,serif" font-size="14" text-anchor="middle">W</text></g><g id="edge3" class="edge"><title>W_-&gt;W_</title><path fill="none" stroke="#000" d="M99.0873,-659.597C109.221,-659.352 117,-657.486 117,-654 117,-651.821 113.961,-650.275 109.208,-649.362"/><polygon fill="#000" stroke="#000" points="109.373 -645.862 99.087 -648.403 108.712 -652.831 109.373 -645.862"/><text x="145" y="-657.8" font-family="Times,serif" font-size="14" text-anchor="middle">R</text><text x="145" y="-642.8" font-family="Times,serif" font-size="14" text-anchor="middle">(waitread)</text></g><g id="edge4" class="edge"><title>W_-&gt;W_</title><path fill="none" stroke="#000" d="M99.1475,-663.668C132.352,-667.535 173,-664.312 173,-654 173,-644.735 140.189,-641.193 109.444,-643.373"/><polygon fill="#000" stroke="#000" points="108.78 -639.92 99.147 -644.332 109.429 -646.89 108.78 -639.92"/><text x="203.5" y="-657.8" font-family="Times,serif" font-size="14" text-anchor="middle">W</text><text x="203.5" y="-642.8" font-family="Times,serif" font-size="14" text-anchor="middle">(waitwrite)</text></g><g id="node6" class="node"><title>C</title><polygon fill="none" stroke="#000" points="155 -567 95.008 -549 155 -531 214.991 -549 155 -567"/><text x="155" y="-545.3" font-family="Times,serif" font-size="14" text-anchor="middle">commit?</text></g><g id="edge5" class="edge"><title>W_-&gt;C</title><path fill="none" stroke="#000" d="M94.4039,-617.841C108.198,-602.398 123.946,-584.767 135.93,-571.35"/><polygon fill="#000" stroke="#000" points="138.803 -573.388 142.854 -563.598 133.582 -568.724 138.803 -573.388"/><text x="133.5" y="-588.8" font-family="Times,serif" font-size="14" text-anchor="middle">W*</text></g><g id="node3" class="node"><title>W</title><polygon fill="none" stroke="#000" points="183 -450 111 -450 111 -378 183 -378 183 -450"/><text x="147" y="-410.3" font-family="Times,serif" font-size="14" text-anchor="middle">written</text></g><g id="edge11" class="edge"><title>W-&gt;W_</title><path fill="none" stroke="#000" d="M117.588,-450.161C101.105,-471.992 81.9191,-501.444 72,-531 63.7594,-555.555 61.3276,-584.401 61.0404,-607.878"/><polygon fill="#000" stroke="#000" points="57.54 -607.917 61.042 -617.916 64.54 -607.915 57.54 -607.917"/><text x="79" y="-545.3" font-family="Times,serif" font-size="14" text-anchor="middle">W</text></g><g id="node7" class="node"><title>D</title><polygon fill="none" stroke="#000" points="147 -312 81.979 -294 147 -276 212.021 -294 147 -312"/><text x="147" y="-290.3" font-family="Times,serif" font-size="14" text-anchor="middle">consume?</text></g><g id="edge8" class="edge"><title>W-&gt;D</title><path fill="none" stroke="#000" d="M147,-377.916C147,-360.082 147,-338.74 147,-322.175"/><polygon fill="#000" stroke="#000" points="150.5 -322.064 147 -312.064 143.5 -322.064 150.5 -322.064"/><text x="179.5" y="-348.8" font-family="Times,serif" font-size="14" text-anchor="middle">R</text><text x="179.5" y="-333.8" font-family="Times,serif" font-size="14" text-anchor="middle">(++readers)</text></g><g id="node4" class="node"><title>R_</title><polygon fill="none" stroke="#000" points="72 -225 0 -225 0 -153 72 -153 72 -225"/><text x="36" y="-185.3" font-family="Times,serif" font-size="14" text-anchor="middle">readable</text></g><g id="edge15" class="edge"><title>R_-&gt;W_</title><path fill="none" stroke="#000" d="M24.6134,-225.355C19.2452,-245.051 14,-270.143 14,-293 14,-550 14,-550 14,-550 14,-570.573 22.0699,-591.411 31.6598,-608.911"/><polygon fill="#000" stroke="#000" points="28.735 -610.844 36.779 -617.739 34.79 -607.333 28.735 -610.844"/><text x="53.5" y="-417.8" font-family="Times,serif" font-size="14" text-anchor="middle">W</text><text x="53.5" y="-402.8" font-family="Times,serif" font-size="14" text-anchor="middle">(readers == 0)</text></g><g id="edge12" class="edge"><title>R_-&gt;R_</title><path fill="none" stroke="#000" d="M72.0873,-194.597C82.2211,-194.352 90,-192.486 90,-189 90,-186.821 86.9614,-185.275 82.2083,-184.362"/><polygon fill="#000" stroke="#000" points="82.373 -180.862 72.087 -183.403 81.712 -187.831 82.373 -180.862"/><text x="122.5" y="-192.8" font-family="Times,serif" font-size="14" text-anchor="middle">R</text><text x="122.5" y="-177.8" font-family="Times,serif" font-size="14" text-anchor="middle">(++readers)</text></g><g id="edge13" class="edge"><title>R_-&gt;R_</title><path fill="none" stroke="#000" d="M72.1065,-198.429C108.294,-202.661 155,-199.518 155,-189 155,-179.427 116.309,-175.964 82.0734,-178.609"/><polygon fill="#000" stroke="#000" points="81.724 -175.127 72.106 -179.571 82.397 -182.094 81.724 -175.127"/><text x="184" y="-192.8" font-family="Times,serif" font-size="14" text-anchor="middle">R*</text><text x="184" y="-177.8" font-family="Times,serif" font-size="14" text-anchor="middle">(--readers)</text></g><g id="node5" class="node"><title>R</title><polygon fill="none" stroke="#000" points="303 -72 231 -72 231 0 303 0 303 -72"/><text x="267" y="-32.3" font-family="Times,serif" font-size="14" text-anchor="middle">reading</text></g><g id="edge14" class="edge"><title>R_-&gt;R</title><path fill="none" stroke="#000" d="M72.0754,-163.294C101.487,-143.27 144.196,-114.464 182,-90 194.93,-81.6325 209.087,-72.7114 222.074,-64.6212"/><polygon fill="#000" stroke="#000" points="224.201 -67.42 230.849 -59.17 220.507 -61.474 224.201 -67.42"/><text x="217.5" y="-123.8" font-family="Times,serif" font-size="14" text-anchor="middle">W</text><text x="217.5" y="-108.8" font-family="Times,serif" font-size="14" text-anchor="middle">(readers &gt; 0)</text><text x="217.5" y="-93.8" font-family="Times,serif" font-size="14" text-anchor="middle">(waitwrite)</text></g><g id="edge17" class="edge"><title>R-&gt;E</title><path fill="none" stroke="#000" d="M293.48,-72.1724C312.938,-101.539 336,-145.343 336,-188 336,-655 336,-655 336,-655 336,-681.696 325.78,-709.518 314.772,-731.743"/><polygon fill="#000" stroke="#000" points="311.518 -730.415 310.033 -740.906 317.736 -733.631 311.518 -730.415"/><text x="380.5" y="-425.3" font-family="Times,serif" font-size="14" text-anchor="middle">R*</text><text x="380.5" y="-410.3" font-family="Times,serif" font-size="14" text-anchor="middle">(--readers == 0)</text><text x="380.5" y="-395.3" font-family="Times,serif" font-size="14" text-anchor="middle">(wakewrite one)</text></g><g id="edge16" class="edge"><title>R-&gt;R</title><path fill="none" stroke="#000" d="M303.087,-43.0898C313.221,-42.7793 321,-40.416 321,-36 321,-33.24 317.961,-31.2818 313.208,-30.1255"/><polygon fill="#000" stroke="#000" points="313.433 -26.628 303.087 -28.91 312.599 -33.578 313.433 -26.628"/><text x="349" y="-39.8" font-family="Times,serif" font-size="14" text-anchor="middle">R</text><text x="349" y="-24.8" font-family="Times,serif" font-size="14" text-anchor="middle">(waitread)</text></g><g id="edge18" class="edge"><title>R-&gt;R</title><path fill="none" stroke="#000" d="M303.147,-48.2461C336.352,-53.1445 377,-49.0625 377,-36 377,-24.2642 344.189,-19.7773 313.444,-22.5393"/><polygon fill="#000" stroke="#000" points="312.669 -19.107 303.147 -23.754 313.489 -26.058 312.669 -19.107"/><text x="407.5" y="-39.8" font-family="Times,serif" font-size="14" text-anchor="middle">W</text><text x="407.5" y="-24.8" font-family="Times,serif" font-size="14" text-anchor="middle">(waitwrite)</text></g><g id="edge7" class="edge"><title>C-&gt;E</title><path fill="none" stroke="#000" d="M180.857,-559.405C205.566,-569.802 241.808,-589.014 261,-618 283.067,-651.329 288.871,-697 289.715,-730.669"/><polygon fill="#000" stroke="#000" points="286.216 -730.747 289.83 -740.706 293.215 -730.666 286.216 -730.747"/><text x="293" y="-650.3" font-family="Times,serif" font-size="14" text-anchor="middle">no</text></g><g id="edge6" class="edge"><title>C-&gt;W</title><path fill="none" stroke="#000" d="M149.034,-532.561C147.008,-526.552 145.005,-519.548 144,-513 141.37,-495.862 141.308,-476.847 142.187,-460.162"/><polygon fill="#000" stroke="#000" points="145.684 -460.319 142.841 -450.112 138.699 -459.864 145.684 -460.319"/><text x="233" y="-501.8" font-family="Times,serif" font-size="14" text-anchor="middle">yes</text><text x="233" y="-486.8" font-family="Times,serif" font-size="14" text-anchor="middle">(++offset)</text><text x="233" y="-471.8" font-family="Times,serif" font-size="14" text-anchor="middle">(wakeread [all, one][consume?])</text></g><g id="edge9" class="edge"><title>D-&gt;R_</title><path fill="none" stroke="#000" d="M132.489,-279.535C119,-267.018 98.2137,-247.73 79.3835,-230.257"/><polygon fill="#000" stroke="#000" points="81.721 -227.651 72.01 -223.414 76.959 -232.782 81.721 -227.651"/><text x="115" y="-246.8" font-family="Times,serif" font-size="14" text-anchor="middle">no</text></g><g id="edge10" class="edge"><title>D-&gt;R</title><path fill="none" stroke="#000" d="M170.707,-282.431C192.504,-271.389 223.816,-251.911 240,-225 266.107,-181.589 270.604,-122.577 270.025,-82.3213"/><polygon fill="#000" stroke="#000" points="273.522 -82.166 269.769 -72.258 266.525 -82.343 273.522 -82.166"/><text x="274.5" y="-185.3" font-family="Times,serif" font-size="14" text-anchor="middle">yes</text></g></g></svg>